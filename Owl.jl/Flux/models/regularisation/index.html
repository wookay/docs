<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>정규화(Regularisation) · 🦉</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link href="../../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>🦉</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../../">Home</a></li><li><span class="toctext">Flux</span><ul><li><a class="toctext" href="../../">Flux 홈</a></li><li><span class="toctext">모델 만들기</span><ul><li><a class="toctext" href="../basics/">기본적인 것</a></li><li><a class="toctext" href="../recurrence/">순환(Recurrence)</a></li><li class="current"><a class="toctext" href>정규화(Regularisation)</a><ul class="internal"></ul></li><li><a class="toctext" href="../layers/">모델 참조(Model Reference)</a></li></ul></li><li><span class="toctext">모델 훈련시키기</span><ul><li><a class="toctext" href="../../training/optimisers/">최적화</a></li><li><a class="toctext" href="../../training/training/">훈련시키기</a></li></ul></li><li><a class="toctext" href="../../data/onehot/">원-핫 인코딩</a></li><li><a class="toctext" href="../../gpu/">GPU 지원</a></li><li><a class="toctext" href="../../saving/">저장 &amp; 불러오기</a></li><li><a class="toctext" href="../../community/">커뮤니티</a></li></ul></li><li><span class="toctext">DataFlow</span><ul><li><a class="toctext" href="../../../DataFlow/vertices/">DataFlow 버티스(vertices)</a></li></ul></li><li><span class="toctext">MacroTools</span><ul><li><a class="toctext" href="../../../MacroTools/README/">MacroTools README</a></li></ul></li><li><span class="toctext">FluxJS</span><ul><li><a class="toctext" href="../../../FluxJS/README/">FluxJS README</a></li></ul></li><li><span class="toctext">GSoC</span><ul><li><a class="toctext" href="../../../soc/guidelines/">Application Guidelines</a></li><li><a class="toctext" href="../../../soc/projects/ml/">Data Science &amp; Machine Learning</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Flux</li><li>모델 만들기</li><li><a href>정규화(Regularisation)</a></li></ul><a class="edit-page" href="https://github.com/wookay/Owl.jl/blob/master/docs/src/Flux/models/regularisation.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>정규화(Regularisation)</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="정규화(Regularisation)-1" href="#정규화(Regularisation)-1">정규화(Regularisation)</a></h1><p>이번에는 모델 파라미터를 정규화 해 보자. <code>vecnorm</code>과 같은 정규화를 해주는 적절한 함수를 각 모델 파라미터에 적용하여 그 결과를 모든 loss에 더하도록 하자.</p><p>예를 들어, 다음과 같은 간단한 regression을 보자.</p><pre><code class="language-julia-repl">julia&gt; using Flux

julia&gt; m = Dense(10, 5)
Dense(10, 5)

julia&gt; loss(x, y) = Flux.crossentropy(softmax(m(x)), y)
loss (generic function with 1 method)</code></pre><p><code>m.W</code>와 <code>m.b</code> 파라미터에 L2 norm을 취하여 정규화 해보자.</p><pre><code class="language-julia-repl">julia&gt; penalty() = vecnorm(m.W) + vecnorm(m.b)
penalty (generic function with 1 method)

julia&gt; loss(x, y) = Flux.crossentropy(softmax(m(x)), y) + penalty()
loss (generic function with 1 method)</code></pre><p>레이어를 이용하는 경우, Flux는 <code>params</code> 함수를 제공하여 모든 파라미터를 한번에 가져올 수 있다. <code>sum(vecnorm, params)</code>를 사용하여 전체를 쉽게 적용할 수 있다.</p><pre><code class="language-julia-repl">julia&gt; params(m)
2-element Array{Any,1}:
 param([-0.61839 -0.556047 … -0.460808 -0.107646; 0.346293 -0.375076 … -0.608704 -0.181025; … ; -0.2226 -0.0992159 … 0.0707984 -0.429173; -0.331058 -0.291995 … 0.383368 0.156716])
 param([0.0, 0.0, 0.0, 0.0, 0.0])

julia&gt; sum(vecnorm, params(m))
2.4130860599427706 (tracked)</code></pre><p>좀 더 큰 규모의 예로, 멀티-레이어 퍼셉트론(perceptron)은 다음과 같다.</p><pre><code class="language-julia-repl">julia&gt; m = Chain(
         Dense(28^2, 128, relu),
         Dense(128, 32, relu),
         Dense(32, 10), softmax)
Chain(Dense(784, 128, NNlib.relu), Dense(128, 32, NNlib.relu), Dense(32, 10), NNlib.softmax)

julia&gt; loss(x, y) = Flux.crossentropy(m(x), y) + sum(vecnorm, params(m))
loss (generic function with 1 method)

julia&gt; loss(rand(28^2), rand(10))
39.128892409412174 (tracked)</code></pre><footer><hr/><a class="previous" href="../recurrence/"><span class="direction">Previous</span><span class="title">순환(Recurrence)</span></a><a class="next" href="../layers/"><span class="direction">Next</span><span class="title">모델 참조(Model Reference)</span></a></footer></article></body></html>

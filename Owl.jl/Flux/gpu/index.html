<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>GPU ì§€ì› Â· ğŸ¦‰</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>ğŸ¦‰</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Flux âœ…</span><ul><li><a class="toctext" href="../">Flux í™ˆ</a></li><li><span class="toctext">ëª¨ë¸ ë§Œë“¤ê¸°</span><ul><li><a class="toctext" href="../models/basics/">ê¸°ë³¸ì ì¸ ê²ƒ</a></li><li><a class="toctext" href="../models/recurrence/">ìˆœí™˜(Recurrence)</a></li><li><a class="toctext" href="../models/regularisation/">ì •ê·œí™”(Regularisation)</a></li><li><a class="toctext" href="../models/layers/">ëª¨ë¸ ì°¸ì¡°(Model Reference)</a></li></ul></li><li><span class="toctext">ëª¨ë¸ í›ˆë ¨ì‹œí‚¤ê¸°</span><ul><li><a class="toctext" href="../training/optimisers/">ìµœì í™”</a></li><li><a class="toctext" href="../training/training/">í›ˆë ¨ì‹œí‚¤ê¸°</a></li></ul></li><li><a class="toctext" href="../data/onehot/">ì›-í•« ì¸ì½”ë”©</a></li><li class="current"><a class="toctext" href>GPU ì§€ì›</a><ul class="internal"></ul></li><li><a class="toctext" href="../saving/">ì €ì¥ &amp; ë¶ˆëŸ¬ì˜¤ê¸°</a></li><li><a class="toctext" href="../community/">ì»¤ë®¤ë‹ˆí‹°</a></li></ul></li><li><span class="toctext">DataFlow</span><ul><li><a class="toctext" href="../../DataFlow/vertices/">DataFlow ë²„í‹°ìŠ¤(vertices)</a></li></ul></li><li><span class="toctext">MacroTools</span><ul><li><a class="toctext" href="../../MacroTools/README/">MacroTools README</a></li></ul></li><li><span class="toctext">FluxJS</span><ul><li><a class="toctext" href="../../FluxJS/README/">FluxJS README</a></li></ul></li><li><span class="toctext">GSoC</span><ul><li><a class="toctext" href="../../soc/guidelines/">Application Guidelines</a></li><li><a class="toctext" href="../../soc/projects/ml/">Data Science &amp; Machine Learning</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Flux âœ…</li><li><a href>GPU ì§€ì›</a></li></ul><a class="edit-page" href="https://github.com/wookay/Owl.jl/blob/master/docs/src/Flux/gpu.md"><span class="fa">ï‚›</span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>GPU ì§€ì›</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="GPU-ì§€ì›-1" href="#GPU-ì§€ì›-1">GPU ì§€ì›</a></h1><p>GPU ê°™ì´ í•˜ë“œì›¨ì–´ ë°±ì—”ë“œë¡œ í•˜ëŠ” ë°°ì—´ ì—°ì‚°ì˜ ì§€ì›ì€ <a href="https://github.com/JuliaGPU/CuArrays.jl">CuArrays</a>ì™€ ê°™ì€ ì™¸ë¶€ íŒ¨í‚¤ì§€ë¥¼ ì œê³µí•œë‹¤. FluxëŠ” ë°°ì—´ì˜ íƒ€ì…ì„ ì •í•˜ì§€ ì•Šì•˜ê¸°ì—(agnostic) ëª¨ë¸ ê°€ì¤‘ì¹˜(weights)ì™€ ë°ì´í„°ë¥¼ GPUì— ì˜®ê²¨ì£¼ë©´ Fluxê°€ ì´ë¥¼ ë‹¤ë£° ìˆ˜ ìˆë‹¤.</p><p>ì˜ˆë¥¼ ë“¤ì–´, <code>CuArrays</code> (<code>cu</code> ì»¨ë²„í„°ë¡œ ë³€í™˜)ë¥¼ ì‚¬ìš©í•˜ì—¬ <a href="../models/basics/">ê¸°ë³¸ ì˜ˆì œ</a>ë¥¼ NVIDIA GPUì—ì„œ ëŒë¦´ ìˆ˜ ìˆë‹¤.</p><pre><code class="language-julia">using CuArrays

W = cu(rand(2, 5)) # 2Ã—5 CuArray
b = cu(rand(2))

predict(x) = W*x .+ b
loss(x, y) = sum((predict(x) .- y).^2)

x, y = cu(rand(5)), cu(rand(2)) # ë”ë¯¸ ë°ì´í„°
loss(x, y) # ~ 3</code></pre><p>íŒŒë¼ë¯¸í„° (<code>W</code>, <code>b</code>)ì™€ ë°ì´í„° ì„¸íŠ¸ (<code>x</code>, <code>y</code>)ë¥¼ cuda ë°°ì—´ë¡œ ë³€í™˜í•˜ì˜€ë‹¤. ë„í•¨ìˆ˜(derivatives)ì™€ í›ˆë ¨ ê°’ì€ ì „ê³¼ ë™ì¼í•˜ë‹¤.</p><p><code>Dense</code> ë ˆì´ì–´ë‚˜ <code>Chain</code> ê°™ì€ ì¡°ë¦½ ëª¨ë¸(structured model)ë¥¼ ì •ì˜í•˜ì˜€ìœ¼ë©´, ë‚´ë¶€ íŒŒë¼ë¯¸í„°ë¥¼ ë³€í™˜ì‹œì¼œì•¼ í•œë‹¤. Fluxì—ì„œ ì œê³µí•˜ëŠ” <code>mapleaves</code> í•¨ìˆ˜ë¡œ ëª¨ë¸ì˜ ëª¨ë“  íŒŒë¼ë¯¸í„°ë¥¼ í•œêº¼ë²ˆì— ë³€ê²½í•  ìˆ˜ ìˆë‹¤.</p><pre><code class="language-julia">d = Dense(10, 5, Ïƒ)
d = mapleaves(cu, d)
d.W # Tracked CuArray
d(cu(rand(10))) # CuArray output

m = Chain(Dense(10, 5, Ïƒ), Dense(5, 2), softmax)
m = mapleaves(cu, m)
d(cu(rand(10)))</code></pre><p>í¸ì˜ìƒ FluxëŠ” <code>gpu</code> í•¨ìˆ˜ë¥¼ ì œê³µí•˜ì—¬ GPUê°€ ì´ìš© ê°€ëŠ¥í•œ ê²½ìš° ëª¨ë¸ê³¼ ë°ì´í„°ë¥¼ GPUë¡œ ë³€í™˜í•˜ê²Œ í•œë‹¤. ê·¸ëƒ¥ì€ ì•”ê²ƒë„ ì•ˆí•˜ì§€ë§Œ <code>CuArrays</code> ë¥¼ ë¡œë”©(using CuArrays)í•œ ê²½ìš°ëŠ” ë°ì´í„°ë¥¼ GPUì— ì˜®ê²¨ì¤€ë‹¤.</p><pre><code class="language-julia-repl">julia&gt; using Flux, CuArrays

julia&gt; m = Dense(10,5) |&gt; gpu
Dense(10, 5)

julia&gt; x = rand(10) |&gt; gpu
10-element CuArray{Float32,1}:
 0.800225
 â‹®
 0.511655

julia&gt; m(x)
Tracked 5-element CuArray{Float32,1}:
 -0.30535
 â‹®
 -0.618002</code></pre><p>ë¹„ìŠ·í•œ ìš©ë„ë¡œ <code>cpu</code>ëŠ” ëª¨ë¸ê³¼ ë°ì´í„°ë¥¼ GPUì—ì„œ ê·¸ë§ŒëŒë¦¬ê²Œ í•œë‹¤.</p><pre><code class="language-julia-repl">julia&gt; x = rand(10) |&gt; gpu
10-element CuArray{Float32,1}:
 0.235164
 â‹®
 0.192538

julia&gt; x |&gt; cpu
10-element Array{Float32,1}:
 0.235164
 â‹®
 0.192538</code></pre><footer><hr/><a class="previous" href="../data/onehot/"><span class="direction">Previous</span><span class="title">ì›-í•« ì¸ì½”ë”©</span></a><a class="next" href="../saving/"><span class="direction">Next</span><span class="title">ì €ì¥ &amp; ë¶ˆëŸ¬ì˜¤ê¸°</span></a></footer></article></body></html>

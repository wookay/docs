<!DOCTYPE html>
<html lang="ko"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ìµœì í™” Â· ğŸ¦‰</title><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-6977995344550016",
          enable_page_level_ads: true
     });
</script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link href="../../../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../../../assets/custom.css" rel="stylesheet" type="text/css"/><script src="assets/jquery-1.8.3.min.js"></script><script src="assets/jquery.word-break-keep-all.min.js"></script><script>$(document).ready(function() { $('p').wordBreakKeepAll(); });</script></head><body><nav class="toc"><h1>ğŸ¦‰</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../../">Home</a></li><li><span class="toctext">Flux âœ…</span><ul><li><a class="toctext" href="../../">Flux í™ˆ</a></li><li><span class="toctext">ëª¨ë¸ ë§Œë“¤ê¸°</span><ul><li><a class="toctext" href="../../models/basics/">ê¸°ë³¸ì ì¸ ê²ƒ</a></li><li><a class="toctext" href="../../models/recurrence/">ìˆœí™˜(Recurrence)</a></li><li><a class="toctext" href="../../models/regularisation/">ì •ê·œí™”(Regularisation)</a></li><li><a class="toctext" href="../../models/layers/">ëª¨ë¸ ì°¸ì¡°(Model Reference)</a></li></ul></li><li><span class="toctext">ëª¨ë¸ í›ˆë ¨ì‹œí‚¤ê¸°</span><ul><li class="current"><a class="toctext" href>ìµœì í™”</a><ul class="internal"><li><a class="toctext" href="#ìµœì í™”-í•¨ìˆ˜-ì°¸ê³ -1">ìµœì í™” í•¨ìˆ˜ ì°¸ê³ </a></li></ul></li><li><a class="toctext" href="../training/">í›ˆë ¨ì‹œí‚¤ê¸°</a></li></ul></li><li><a class="toctext" href="../../data/onehot/">ì›-í•« ì¸ì½”ë”©</a></li><li><a class="toctext" href="../../gpu/">GPU ì§€ì›</a></li><li><a class="toctext" href="../../saving/">ì €ì¥ &amp; ë¶ˆëŸ¬ì˜¤ê¸°</a></li><li><a class="toctext" href="../../community/">ì»¤ë®¤ë‹ˆí‹°</a></li></ul></li><li><span class="toctext">DataFlow âœ…</span><ul><li><a class="toctext" href="../../../DataFlow/vertices/">DataFlow ë²„í‹°ìŠ¤(vertices)</a></li></ul></li><li><span class="toctext">MacroTools</span><ul><li><a class="toctext" href="../../../MacroTools/README/">MacroTools README</a></li></ul></li><li><span class="toctext">FluxJS</span><ul><li><a class="toctext" href="../../../FluxJS/README/">FluxJS README</a></li></ul></li><li><span class="toctext">Vinyl</span><ul><li><a class="toctext" href="../../../Vinyl/README/">Vinyl README</a></li></ul></li><li><span class="toctext">GSoC</span><ul><li><a class="toctext" href="../../../soc/guidelines/">Application Guidelines</a></li><li><a class="toctext" href="../../../soc/projects/ml/">Data Science &amp; Machine Learning</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Flux âœ…</li><li>ëª¨ë¸ í›ˆë ¨ì‹œí‚¤ê¸°</li><li><a href>ìµœì í™”</a></li></ul><a class="edit-page" href="https://github.com/wookay/Owl.jl/blob/master/docs/src/Flux/training/optimisers.md"><span class="fa">ï‚›</span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>ìµœì í™”</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="ìµœì í™”-í•¨ìˆ˜(Optimisers)-1" href="#ìµœì í™”-í•¨ìˆ˜(Optimisers)-1">ìµœì í™” í•¨ìˆ˜(Optimisers)</a></h1><p><a href="../../models/basics/">ê°„ë‹¨í•œ ë¦¬ë‹ˆì–´ ë¦¬ê·¸ë ˆì…˜</a>ì—ì„œ ìš°ë¦¬ëŠ” ë”ë¯¸ ë°ì´í„°ë¥¼ ë§Œë“  í›„, ì†ì‹¤(loss)ì„ ê³„ì‚°í•˜ê³  ì—­ì „íŒŒ(backpropagate) í•˜ì—¬ íŒŒë¼ë¯¸í„° <code>W</code>ì™€ <code>b</code>ì˜ ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°í•˜ì˜€ë‹¤.</p><pre><code class="language-julia-repl">julia&gt; using Flux

julia&gt; W = param(rand(2, 5))
Tracked 2Ã—5 Array{Float64,2}:
 0.215021  0.22422   0.352664  0.11115   0.040711
 0.180933  0.769257  0.361652  0.783197  0.545495

julia&gt; b = param(rand(2))
Tracked 2-element Array{Float64,1}:
 0.205216
 0.150938

julia&gt; predict(x) = W*x .+ b
predict (generic function with 1 method)

julia&gt; loss(x, y) = sum((predict(x) .- y).^2)
loss (generic function with 1 method)

julia&gt; x, y = rand(5), rand(2) # ë”ë¯¸ ë°ì´í„°
([0.153473, 0.927019, 0.40597, 0.783872, 0.392236], [0.261727, 0.00917161])

julia&gt; l = loss(x, y) # ~ 3
3.6352060699201565 (tracked)

julia&gt; Flux.back!(l)
</code></pre><p>ê¸°ìš¸ê¸°ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒë¼ë¯¸í„°ë¥¼ ì—…ë°ì´íŠ¸ í•˜ê³ ì í•œë‹¤. ì†ì‹¤ì„ ì¤„ì´ë ¤ê³  ë§ì´ë‹¤. ì—¬ê¸°ì„œ í•œê°€ì§€ ë°©ë²•ì€:</p><pre><code class="language-julia">function update()
  Î· = 0.1 # í•™ìŠµí•˜ëŠ” ì†ë„(Learning Rate)
  for p in (W, b)
    p.data .-= Î· .* p.grad # ì—…ë°ì´íŠ¸ ì ìš©
    p.grad .= 0            # ê¸°ìš¸ê¸° 0ìœ¼ë¡œ clear
  end
end</code></pre><p><code>update</code>ë¥¼ í˜¸ì¶œí•˜ë©´ íŒŒë¼ë¯¸í„° <code>W</code>ì™€ <code>b</code>ëŠ” ë°”ë€Œê³  ì†ì‹¤(loss)ì€ ë‚´ë ¤ê°„ë‹¤.</p><p>ë‘ê°€ì§€ëŠ” ì§šê³  ë„˜ì–´ê°€ì: ëª¨ë¸ì—ì„œ í›ˆë ¨í•  íŒŒë¼ë¯¸í„°ì˜ ëª©ë¡ (ì—¬ê¸°ì„œëŠ” <code>[W, b]</code>), ê·¸ë¦¬ê³  ì—…ë°ì´íŠ¸ ì§„í–‰ ì†ë„. ì—¬ê¸°ì„œì˜ ì—…ë°ì´íŠ¸ëŠ” ê°„ë‹¨í•œ gradient descent(ê²½ì‚¬ í•˜ê°•, <code>x .-= Î· .* Î”</code>) ì˜€ì§€ë§Œ, ëª¨ë©˜í…€(momentum)ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ë‹¤ ì–´ë ¤ìš´ ê²ƒë„ í•´ë³´ê³  ì‹¶ì„ ê²ƒì´ë‹¤.</p><p>ì—¬ê¸°ì„œ ë³€ìˆ˜ë¥¼ ì–»ëŠ” ê²ƒì€ ì•„ë¬´ê²ƒë„ ì•„ë‹ˆì§€ë§Œ, ë ˆì´ì–´ë¥¼ ë³µì¡í•˜ê²Œ ìŒ“ëŠ”ë‹¤ë©´ ê³¨ì¹˜ ì¢€ ì•„í”Œ ê²ƒì´ë‹¤.</p><pre><code class="language-julia-repl">julia&gt; m = Chain(
         Dense(10, 5, Ïƒ),
         Dense(5, 2), softmax)
Chain(Dense(10, 5, NNlib.Ïƒ), Dense(5, 2), NNlib.softmax)</code></pre><p><code>[m[1].W, m[1].b, ...]</code> ì´ë ‡ê²Œ ì‘ì„±í•˜ëŠ” ê²ƒ ëŒ€ì‹ , Fluxì—ì„œ ì œê³µí•˜ëŠ” <code>params(m)</code> í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ëª¨ë¸ì˜ ëª¨ë“  íŒŒë¼ë¯¸í„°ì˜ ëª©ë¡ì„ êµ¬í•  ê²ƒì´ë‹¤.</p><pre><code class="language-julia-repl">julia&gt; opt = SGD([W, b], 0.1) # Gradient descent(ê²½ì‚¬ í•˜ê°•)ì„ learning rate(í•™ìŠµ ì†ë„) 0.1 ìœ¼ë¡œ í•œë‹¤
(::#71) (generic function with 1 method)

julia&gt; opt() # `W`ì™€ `b`ë¥¼ ë³€ê²½í•˜ë©° ì—…ë°ì´íŠ¸ë¥¼ ìˆ˜í–‰í•œë‹¤
</code></pre><p>ìµœì í™” í•¨ìˆ˜ëŠ” íŒŒë¼ë¯¸í„° ëª©ë¡ì„ ë°›ì•„ ìœ„ì˜ <code>update</code>ì™€ ê°™ì€ í•¨ìˆ˜ë¥¼ ëŒë ¤ì¤€ë‹¤. <code>opt</code>ë‚˜ <code>update</code>ë¥¼ <a href="../training/">í›ˆë ¨ ë£¨í”„(training loop)</a>ì— ë„˜ê²¨ì¤„ ìˆ˜ ìˆëŠ”ë°, ë§¤ë²ˆ ë°ì´í„°ì˜ ë¯¸ë‹ˆ-ë°°ì¹˜(mini-batch)ë¥¼ í•œ í›„ì— ìµœì í™”ë¥¼ ìˆ˜í–‰í•  ê²ƒì´ë‹¤.</p><h2><a class="nav-anchor" id="ìµœì í™”-í•¨ìˆ˜-ì°¸ê³ -1" href="#ìµœì í™”-í•¨ìˆ˜-ì°¸ê³ -1">ìµœì í™” í•¨ìˆ˜ ì°¸ê³ </a></h2><p>ëª¨ë“  ìµœì í™” í•¨ìˆ˜ëŠ” ë„˜ê²¨ë°›ì€ íŒŒë¼ë¯¸í„°ë¥¼ ì—…ë°ì´íŠ¸ í•˜ëŠ” í•¨ìˆ˜ë¥¼ ëŒë ¤ì¤€ë‹¤.</p><pre><code class="language-none">SGD
Momentum
Nesterov
ADAM</code></pre><footer><hr/><a class="previous" href="../../models/layers/"><span class="direction">ì´ì „ê¸€</span><span class="title">ëª¨ë¸ ì°¸ì¡°(Model Reference)</span></a><a class="next" href="../training/"><span class="direction">ë‹¤ìŒê¸€</span><span class="title">í›ˆë ¨ì‹œí‚¤ê¸°</span></a></footer></article></body></html>

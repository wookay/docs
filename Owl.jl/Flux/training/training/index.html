<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ν›λ ¨μ‹ν‚¤κΈ° Β· π¦‰</title><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-6977995344550016",
          enable_page_level_ads: true
     });
</script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link href="../../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>π¦‰</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../../">Home</a></li><li><span class="toctext">Flux β…</span><ul><li><a class="toctext" href="../../">Flux ν™</a></li><li><span class="toctext">λ¨λΈ λ§λ“¤κΈ°</span><ul><li><a class="toctext" href="../../models/basics/">κΈ°λ³Έμ μΈ κ²ƒ</a></li><li><a class="toctext" href="../../models/recurrence/">μν™(Recurrence)</a></li><li><a class="toctext" href="../../models/regularisation/">μ •κ·ν™”(Regularisation)</a></li><li><a class="toctext" href="../../models/layers/">λ¨λΈ μ°Έμ΅°(Model Reference)</a></li></ul></li><li><span class="toctext">λ¨λΈ ν›λ ¨μ‹ν‚¤κΈ°</span><ul><li><a class="toctext" href="../optimisers/">μµμ ν™”</a></li><li class="current"><a class="toctext" href>ν›λ ¨μ‹ν‚¤κΈ°</a><ul class="internal"><li><a class="toctext" href="#μ†μ‹¤-ν•¨μ(Loss-Functions)-1">μ†μ‹¤ ν•¨μ(Loss Functions)</a></li><li><a class="toctext" href="#λ°μ΄ν„°μ„ΈνΈ(Datasets)-1">λ°μ΄ν„°μ„ΈνΈ(Datasets)</a></li><li><a class="toctext" href="#μ»¬λ°±(Callbacks)-1">μ»¬λ°±(Callbacks)</a></li></ul></li></ul></li><li><a class="toctext" href="../../data/onehot/">μ›-ν•« μΈμ½”λ”©</a></li><li><a class="toctext" href="../../gpu/">GPU μ§€μ›</a></li><li><a class="toctext" href="../../saving/">μ €μ¥ &amp; λ¶λ¬μ¤κΈ°</a></li><li><a class="toctext" href="../../community/">μ»¤λ®¤λ‹ν‹°</a></li></ul></li><li><span class="toctext">DataFlow β…</span><ul><li><a class="toctext" href="../../../DataFlow/vertices/">DataFlow λ²„ν‹°μ¤(vertices)</a></li></ul></li><li><span class="toctext">MacroTools</span><ul><li><a class="toctext" href="../../../MacroTools/README/">MacroTools README</a></li></ul></li><li><span class="toctext">FluxJS</span><ul><li><a class="toctext" href="../../../FluxJS/README/">FluxJS README</a></li></ul></li><li><span class="toctext">Vinyl</span><ul><li><a class="toctext" href="../../../Vinyl/README/">Vinyl README</a></li></ul></li><li><span class="toctext">GSoC</span><ul><li><a class="toctext" href="../../../soc/guidelines/">Application Guidelines</a></li><li><a class="toctext" href="../../../soc/projects/ml/">Data Science &amp; Machine Learning</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Flux β…</li><li>λ¨λΈ ν›λ ¨μ‹ν‚¤κΈ°</li><li><a href>ν›λ ¨μ‹ν‚¤κΈ°</a></li></ul><a class="edit-page" href="https://github.com/wookay/Owl.jl/blob/master/docs/src/Flux/training/training.md"><span class="fa">ο‚›</span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>ν›λ ¨μ‹ν‚¤κΈ°</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="ν›λ ¨μ‹ν‚¤ν‚¤(Training)-1" href="#ν›λ ¨μ‹ν‚¤ν‚¤(Training)-1">ν›λ ¨μ‹ν‚¤ν‚¤(Training)</a></h1><p>λ¨λΈμ„ ν›λ ¨μ‹ν‚¤λ ¤λ©΄ μ„Έ κ°€μ§€κ°€ ν•„μ”ν•λ‹¤:</p><ul><li><p><em>λ©ν‘ ν•¨μ(objective function)</em>, μ£Όμ–΄μ§„ λ°μ΄ν„°λ¥Ό μ–Όλ§νΌ μ ν‰κ°€ν•  κ²ƒμΈκ°€.</p></li><li><p>λ°μ΄ν„° ν¬μΈνΈμ λ¬¶μ(A collection of data points)μ„ λ©ν‘ ν•¨μμ— λ„κ²¨μ¤„ κ²ƒμ΄λ‹¤.</p></li><li><p><a href="../optimisers/">μµμ ν™” ν•¨μ</a>λ΅ λ¨λΈ νλΌλ―Έν„°λ¥Ό μ μ ν•κ² μ—…λ°μ΄νΈ ν•  κ²ƒμ΄λ‹¤.</p></li></ul><p>κ·Έλ¦¬ν•μ—¬ <code>Flux.train!</code>λ” λ‹¤μκ³Ό κ°™μ΄ νΈμ¶ν•λ‹¤:</p><pre><code class="language-julia">Flux.train!(objective, data, opt)</code></pre><p><a href="https://github.com/FluxML/model-zoo">λ¨λΈ λ™λ¬Όμ›(model zoo)</a>μ— μ—¬λ¬κ°€μ§€ μμ κ°€ μλ‹¤.</p><h2><a class="nav-anchor" id="μ†μ‹¤-ν•¨μ(Loss-Functions)-1" href="#μ†μ‹¤-ν•¨μ(Loss-Functions)-1">μ†μ‹¤ ν•¨μ(Loss Functions)</a></h2><p>λ©ν‘ ν•¨μλ” λ°λ“μ‹ λ¨λΈκ³Ό λ€μƒ(target)μ μ°¨μ΄λ¥Ό λ‚νƒ€λ‚΄λ” μ«μλ¥Ό λλ ¤μ£Όμ–΄μ•Ό ν•λ‹¤ - λ¨λΈμ <em>loss</em>. <a href="../../models/basics/">κΈ°μ΄</a>μ—μ„ μ •μν• <code>loss</code> ν•¨μκ°€ λ©ν‘(an objective)λ΅μ„ μ‘λ™ν•  κ²ƒμ΄λ‹¤. λ¨λΈμ κ΄€μ μ—μ„ λ©ν‘λ¥Ό μ •μν•  μλ„ μλ‹¤:</p><pre><code class="language-julia-repl">julia&gt; using Flux

julia&gt; m = Chain(
         Dense(784, 32, Οƒ),
         Dense(32, 10), softmax)
Chain(Dense(784, 32, NNlib.Οƒ), Dense(32, 10), NNlib.softmax)

julia&gt; loss(x, y) = Flux.mse(m(x), y)
loss (generic function with 1 method)

# λ‚μ¤‘μ—
julia&gt; Flux.train!(loss, data, opt)</code></pre><p>λ©ν‘λ” ν•­μƒ <code>m(x)</code>μ μμΈ΅κ³Ό λ€μƒ <code>y</code>μ κ±°λ¦¬λ¥Ό μΈ΅μ •ν•λ” <em>λΉ„μ© ν•¨μ(cost function)</em>μ κ΄€μ μ—μ„ μ •μλλ‹¤. Fluxλ” mean squared errorλ¥Ό κµ¬ν•λ” <code>mse</code>λ‚, cross entropy lossλ¥Ό κµ¬ν•λ” <code>crossentropy</code> κ°™μ€ λΉ„μ© ν•¨μλ¥Ό λ‚΄μ¥ν•κ³  μλ‹¤. μ›ν•λ‹¤λ©΄ μ§μ ‘ κ³„μ‚°ν•΄ λ³Ό μλ„ μλ‹¤.</p><h2><a class="nav-anchor" id="λ°μ΄ν„°μ„ΈνΈ(Datasets)-1" href="#λ°μ΄ν„°μ„ΈνΈ(Datasets)-1">λ°μ΄ν„°μ„ΈνΈ(Datasets)</a></h2><p><code>data</code> μΈμλ” ν›λ ¨ν•  λ°μ΄ν„°(λ³΄ν†µ μ…λ ¥ <code>x</code>μ™€ target μ¶λ ¥ <code>y</code>)μ λ¬¶μμ„ μ κ³µν•λ‹¤. μλ¥Ό λ“¤μ–΄, λ”± ν•λ‚ μλ” λ”λ―Έ λ°μ΄ν„° μ„ΈνΈλ” λ‹¤μκ³Ό κ°™λ‹¤:</p><pre><code class="language-julia">x = rand(784)
y = rand(10)
data = [(x, y)]</code></pre><p><code>Flux.train!</code>μ€ <code>loss(x, y)</code>μ„ νΈμ¶ν•κ³ , κΈ°μΈκΈ°λ¥Ό κ³„μ‚°ν•λ©°, κ°€μ¤‘μΉ(weights)λ¥Ό μ—…λ°μ΄νΈν•κ³  λ‹¤μ λ°μ΄ν„° ν¬μΈνΈλ΅ μ΄λ™ν•λ‹¤. κ°™μ€ λ°μ΄ν„°λ¥Ό μ„Έ λ² ν›λ ¨μ‹ν‚¬ μ μλ‹¤:</p><pre><code class="language-julia">data = [(x, y), (x, y), (x, y)]
# λλ” μ•„λμ™€ κ°™μ΄
data = Iterators.repeated((x, y), 3)</code></pre><p><code>x</code>μ™€ <code>y</code>λ” λ³„λ„λ΅ μ½μ–΄λ“¤μ–΄λ” κ²ƒμ΄ λ³΄ν†µμ΄λ‹¤. μ΄λ΄ κ²½μ°μ— <code>zip</code>μ„ μ“Έ μ μλ‹¤:</p><pre><code class="language-julia">xs = [rand(784), rand(784), rand(784)]
ys = [rand( 10), rand( 10), rand( 10)]
data = zip(xs, ys)</code></pre><p>κΈ°λ³Έμ μΌλ΅ <code>train!</code>μ€ λ°μ΄ν„°λ¥Ό μ¤μ§ ν•λ²λ§ μνν•λ‹¤ (ν• μ„Έλ€, a single &quot;epoch&quot;). μ—¬λ¬ μ„Έλ€λ¥Ό λλ¦¬λ” <code>@epochs</code> λ§¤ν¬λ΅λ¥Ό μ κ³µν•κ³  μμΌλ‹ REPLμ—μ„ λ‹¤μκ³Ό κ°™μ΄ ν•΄ λ³΄μ.</p><pre><code class="language-julia-repl">julia&gt; using Flux: @epochs

julia&gt; @epochs 2 println(&quot;hello&quot;)
INFO: Epoch 1
hello
INFO: Epoch 2
hello

julia&gt; @epochs 2 Flux.train!(...)
# λ‘ μ„Έλ€μ— κ±Έμ³ ν›λ ¨ν•λ‹¤</code></pre><h2><a class="nav-anchor" id="μ»¬λ°±(Callbacks)-1" href="#μ»¬λ°±(Callbacks)-1">μ»¬λ°±(Callbacks)</a></h2><p><code>train!</code>μ€ <code>cb</code> μΈμλ¥Ό μ¶”κ°€μ μΌλ΅ λ°›λ”λ°, μ»¬λ°± ν•¨μλ¥Ό μ¤μ„ ν›λ ¨ κ³Όμ •μ„ μ§€μΌλ³Ό μ μλ‹¤. μλ¥Ό λ“¤λ©΄:</p><pre><code class="language-julia">train!(objective, data, opt, cb = () -&gt; println(&quot;training&quot;))</code></pre><p>μ»¬λ°±μ€ ν›λ ¨ λ°μ΄ν„°μ λ°°μΉ(batch) λ§λ‹¤ νΈμ¶λλ‹¤. μΆ€λ” μ κ² νΈμ¶ν•λ ¤λ©΄ <code>Flux.throttle(f, timeout)</code>λ¥Ό μ£Όμ–΄ <code>f</code>κ°€ λ§¤ <code>timeout</code> μ΄ μ΄μƒ νΈμ¶λλ” κ²ƒμ„ λ§‰λ”λ‹¤.</p><p>μ»¬λ°±μ„ μ‚¬μ©ν•λ” μ „ν•μ μΈ λ°©μ‹μ€ λ‹¤μκ³Ό κ°™λ‹¤:</p><pre><code class="language-julia">test_x, test_y = # ... ν…μ¤νΈ λ°μ΄ν„°μ λ‹¨μΌ λ°°μΉ(single batch) λ§λ“¤κΈ° ...
evalcb() = @show(loss(test_x, test_y))

Flux.train!(objective, data, opt,
            cb = throttle(evalcb, 5))</code></pre><footer><hr/><a class="previous" href="../optimisers/"><span class="direction">Previous</span><span class="title">μµμ ν™”</span></a><a class="next" href="../../data/onehot/"><span class="direction">Next</span><span class="title">μ›-ν•« μΈμ½”λ”©</span></a></footer></article></body></html>
